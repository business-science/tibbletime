<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Collapse a tbl_time object by its index â€” collapse_by â€¢ tibbletime</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Collapse a tbl_time object by its index â€” collapse_by" />

<meta property="og:description" content="Collapse the index of a tbl_time object by time period. The index column
is altered so that all dates that fall in a specified interval share a
common date." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-76139189-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-76139189-1');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tibbletime</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Function Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/TT-01-time-based-filtering.html">Time-based filtering</a>
    </li>
    <li>
      <a href="../articles/TT-02-changing-time-periods.html">Changing periodicity</a>
    </li>
    <li>
      <a href="../articles/TT-03-rollify-for-rolling-analysis.html">Rolling calculations in tibbletime</a>
    </li>
    <li>
      <a href="../articles/TT-04-use-with-dplyr.html">Using tibbletime with dplyr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/business-science/tibbletime">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Collapse a tbl_time object by its index</h1>
    <small class="dont-index">Source: <a href='https://github.com/business-science/tibbletime/blob/master/R/collapse_index.R'><code>R/collapse_index.R</code></a></small>
    <div class="hidden name"><code>collapse_by.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Collapse the index of a <code>tbl_time</code> object by time period. The index column
is altered so that all dates that fall in a specified interval share a
common date.</p>
    
    </div>

    <pre class="usage"><span class='fu'>collapse_by</span>(<span class='no'>.tbl_time</span>, <span class='kw'>period</span> <span class='kw'>=</span> <span class='st'>"yearly"</span>, <span class='kw'>start_date</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>side</span> <span class='kw'>=</span> <span class='st'>"end"</span>, <span class='kw'>clean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.tbl_time</th>
      <td><p>A <code>tbl_time</code> object.</p></td>
    </tr>
    <tr>
      <th>period</th>
      <td><p>A character specification used for time-based grouping. The
general format to use is <code>"frequency period"</code> where frequency is a number
like 1 or 2, and period is an interval like weekly or yearly. There must be
a space between the two.</p>
<p>Note that you can pass the specification in a flexible way:</p><ul>
<li><p>1 Year: <code>'1 year'</code> / <code>'1 Y'</code> / <code>'1 yearly'</code> / <code>'yearly'</code></p></li>
</ul>

<p>This shorthand is available for year, quarter, month, day, hour, minute,
second, millisecond and microsecond periodicities.</p>
<p>Additionally, you have the option of passing in a vector of dates to
use as custom and more flexible boundaries.</p></td>
    </tr>
    <tr>
      <th>start_date</th>
      <td><p>Optional argument used to
specify the start date for the
first group. The default is to start at the closest period boundary
below the minimum date in the supplied index.</p></td>
    </tr>
    <tr>
      <th>side</th>
      <td><p>Whether to return the date at the beginning or the end of
the new period. By default, the "end" of the period.
Use "start" to change to the start of the period.</p></td>
    </tr>
    <tr>
      <th>clean</th>
      <td><p>Whether or not to round the collapsed index up / down to the next
period boundary. The decision to round up / down is controlled by the side
argument.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Not currently used.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>collapse_by()</code> is a simplification of a call to <code><a href='https://dplyr.tidyverse.org/reference/mutate.html'>dplyr::mutate()</a></code> to collapse an
index column using <code><a href='collapse_index.html'>collapse_index()</a></code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Basic functionality -------------------------------------------------------</span>

<span class='co'># Facebook stock prices</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>FB</span>)
<span class='no'>FB</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='tbl_time.html'>as_tbl_time</a></span>(<span class='no'>FB</span>, <span class='no'>date</span>)

<span class='co'># Collapse to weekly dates</span>
<span class='fu'>collapse_by</span>(<span class='no'>FB</span>, <span class='st'>"weekly"</span>)</div><div class='output co'>#&gt; # A time tibble: 1,008 x 8
#&gt; [90m# Index: date[39m
#&gt;    symbol date        open  high   low close    volume adjusted
#&gt;    [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;date&gt;[39m[23m     [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m     [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m
#&gt; [90m 1[39m FB     2013-01-04  27.4  28.2  27.4  28    69[4m8[24m[4m4[24m[4m6[24m400     28  
#&gt; [90m 2[39m FB     2013-01-04  27.9  28.5  27.6  27.8  63[4m1[24m[4m4[24m[4m0[24m600     27.8
#&gt; [90m 3[39m FB     2013-01-04  28.0  28.9  27.8  28.8  72[4m7[24m[4m1[24m[4m5[24m400     28.8
#&gt; [90m 4[39m FB     2013-01-11  28.7  29.8  28.6  29.4  83[4m7[24m[4m8[24m[4m1[24m800     29.4
#&gt; [90m 5[39m FB     2013-01-11  29.5  29.6  28.9  29.1  45[4m8[24m[4m7[24m[4m1[24m300     29.1
#&gt; [90m 6[39m FB     2013-01-11  29.7  30.6  29.5  30.6 104[4m7[24m[4m8[24m[4m7[24m700     30.6
#&gt; [90m 7[39m FB     2013-01-11  30.6  31.5  30.3  31.3  95[4m3[24m[4m1[24m[4m6[24m400     31.3
#&gt; [90m 8[39m FB     2013-01-11  31.3  32.0  31.1  31.7  89[4m5[24m[4m9[24m[4m8[24m000     31.7
#&gt; [90m 9[39m FB     2013-01-18  32.1  32.2  30.6  31.0  98[4m8[24m[4m9[24m[4m2[24m800     31.0
#&gt; [90m10[39m FB     2013-01-18  30.6  31.7  29.9  30.1 173[4m2[24m[4m4[24m[4m2[24m600     30.1
#&gt; [90m# â€¦ with 998 more rows[39m</div><div class='input'>
<span class='co'># A common workflow is to group on the collapsed date column</span>
<span class='co'># to perform a time based summary</span>
<span class='no'>FB</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>collapse_by</span>(<span class='st'>"yearly"</span>) <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>date</span>) <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise_all.html'>summarise_if</a></span>(<span class='no'>is.numeric</span>, <span class='no'>mean</span>)</div><div class='output co'>#&gt; # A time tibble: 4 x 7
#&gt; [90m# Index: date[39m
#&gt;   date        open  high   low close    volume adjusted
#&gt;   [3m[90m&lt;date&gt;[39m[23m     [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m     [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m
#&gt; [90m1[39m 2013-12-31  35.5  36.0  34.9  35.5 60[4m0[24m[4m9[24m[4m1[24m994.     35.5
#&gt; [90m2[39m 2014-12-31  68.8  69.6  67.8  68.8 47[4m5[24m[4m3[24m[4m0[24m552.     68.8
#&gt; [90m3[39m 2015-12-31  88.7  89.7  87.8  88.8 26[4m9[24m[4m5[24m[4m5[24m191.     88.8
#&gt; [90m4[39m 2016-12-30 117.  118.  116.  117.  25[4m4[24m[4m5[24m[4m3[24m798.    117. </div><div class='input'>
<span class='co'># Grouped functionality -----------------------------------------------------</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>FANG</span>)
<span class='no'>FANG</span> <span class='kw'>&lt;-</span> <span class='no'>FANG</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='tbl_time.html'>as_tbl_time</a></span>(<span class='no'>date</span>) <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>symbol</span>)

<span class='co'># Collapse each group to monthly,</span>
<span class='co'># calculate monthly standard deviation for each column</span>
<span class='no'>FANG</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>collapse_by</span>(<span class='st'>"monthly"</span>) <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>date</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='kw'>%&gt;%</span>
  <span class='kw pkg'>dplyr</span><span class='kw ns'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise_all.html'>summarise_all</a></span>(<span class='no'>sd</span>)</div><div class='output co'>#&gt; # A time tibble: 192 x 8
#&gt; [90m# Index:  date[39m
#&gt; [90m# Groups: symbol [?][39m
#&gt;    symbol date        open  high   low close   volume adjusted
#&gt;    [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;date&gt;[39m[23m     [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m
#&gt; [90m 1[39m AMZN   2013-01-31  7.11  7.21  5.63  6.31 2[4m8[24m[4m5[24m[4m1[24m878.     6.31
#&gt; [90m 2[39m AMZN   2013-02-28  3.21  3.38  3.26  3.82  [4m8[24m[4m6[24m[4m3[24m971.     3.82
#&gt; [90m 3[39m AMZN   2013-03-28  7.50  7.29  7.51  7.67  [4m9[24m[4m2[24m[4m9[24m111.     7.67
#&gt; [90m 4[39m AMZN   2013-04-30  6.32  6.22  6.15  6.69 2[4m6[24m[4m8[24m[4m8[24m623.     6.69
#&gt; [90m 5[39m AMZN   2013-05-31  5.40  5.60  6.44  5.72  [4m7[24m[4m8[24m[4m1[24m265.     5.72
#&gt; [90m 6[39m AMZN   2013-06-28  4.29  4.45  4.91  4.70  [4m6[24m[4m9[24m[4m2[24m542.     4.70
#&gt; [90m 7[39m AMZN   2013-07-31 10.1   9.68  9.09  9.04 1[4m5[24m[4m9[24m[4m2[24m530.     9.04
#&gt; [90m 8[39m AMZN   2013-08-30  7.67  7.08  6.98  7.65  [4m4[24m[4m4[24m[4m3[24m340.     7.65
#&gt; [90m 9[39m AMZN   2013-09-30  9.67  9.37  9.37  9.18  [4m8[24m[4m4[24m[4m7[24m804.     9.18
#&gt; [90m10[39m AMZN   2013-10-31 20.6  21.4  20.7  21.4  2[4m2[24m[4m0[24m[4m9[24m026.    21.4 
#&gt; [90m# â€¦ with 182 more rows[39m</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Davis Vaughan, Matt Dancho.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

